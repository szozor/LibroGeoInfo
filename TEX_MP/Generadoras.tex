\seccion{Funciones generatrices}
\label{s:MP:generatrices}


%\subseccion{Funciones generatrices}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\aver{
Se  definen  un conjunto  de  funciones  que  permiten hallar  f\'acilmente  los
distintos   momentos  de   una   distribuci\'on  de   probabilidad.  Se   llaman
\emph{funciones  generadoras} o \emph{funciones  generatrices}, y  est\'an dadas
como valores de expectaci\'on de  funciones de la variable aleatoria (discreta o
continua), con un par\'ametro real o complejo.

La  \emph{funci\'on  generadora   de  momentos}  (MGF,  \emph{moment  generating
  function}) se define como
$$
M(\xi) \equiv \langle e^{\xi X} \rangle =  \int e^{\xi x} p(x) \, dx , \quad \xi
\in \Rset
$$
en el  caso de una variable  aleatoria continua $X$  con pdf $p(x)$. Se  tiene \
$M(0)=\int p(x)\,dx=1$ (que corresponde a la condici\'on de normalizaci\'on). Si
la  variable $X$ es  positiva y  se toma  $\xi=-s$ con  $s>0$, se  interpreta en
t\'erminos de la transformada de Laplace de la funci\'on $p$.  %%
\\
Si existe, la  MGF posibilita obtener f\'acilmente los  momentos (ordinarios) de
$X$ a  distintos \'ordenes, mediante los  coeficientes del desarrollo  de $M$ en
serie de potencias de $\xi$:
$$
M(\xi)  =  \sum_{r=0}^{\infty}  \frac{\xi^r}{r!}  \int  x^r  p(x)  \,  dx  =  1+
\sum_{r=1}^{\infty} \frac{\nu_r}{r!} \xi^r
$$
o, alternativamente, mediante  las sucesivas derivadas de $M$  respecto de $\xi$
en 0:
$$
\nu_r=\left.  \frac{d^r  M(\xi)}{d\xi^r}\right|_{\xi=0}  ,  \quad  r=1,2,\ldots;
\quad \nu_0\equiv 1 .
$$ 

En  el  caso de  una  variable aleatoria  discreta,  suponiendo  que el  espacio
muestral es $\Nset$, se definen  dos funciones: la \emph{funci\'on generadora de
  momentos (ordinarios)} (MGF) dada por
$$
M(\xi) \equiv \langle e^{\xi N} \rangle = \sum_{n\geq 0} e^{\xi n} p_n ,
%% = \sum_{r\equiv 0} \frac{\langle n^r\rangle}{r!} \xi^r , 
$$
y la \emph{funci\'on generadora  de momentos factoriales} (FMGF, \emph{factorial
  moment generating function}) como
$$
F(\xi) \equiv \langle (1+\xi)^N \rangle = \sum_{n\geq 0} (1+\xi)^n p_n
$$
para    $\xi     \in    \Rset$    en     ambos    casos.    Se     verifica    \
$M(0)=F(0)=\sum_{n=0}^{\infty} p_n=1$. Se muestra simplemente que
$$
M(\xi) = \sum_{r=0}^{\infty} \frac{\langle n^r\rangle}{r!} \xi^r , 
$$
lo que  permite obtener los momentos  de la distribuci\'on  para cualquier orden
$r\geq 1$. Por otro lado, el desarrollo de la FMGF da
$$
F(\xi)  =   \sum_{n=  0}^{\infty}  \sum_{r=   0}^n  \binom{n}{r}  \xi^r   p_n  =
\sum_{r=0}^\infty \sum_{n=r}^{\infty} \frac{n(n-1)\cdots (n-r+1)}{r!}  \xi^r p_n
= \sum_{r=0}^{\infty} \frac{\langle n^{(r)}\rangle}{r!} \xi^r
$$
teniendo  en cuenta  en las  dobles sumas  que $0\leq  r\leq n$,  con  $n$ hasta
$n_{\max}$ \'o  $\infty$. Se  ve entonces que  $F$ permite obtener  los momentos
factoriales de orden $r$ arbitrario.

Dada   una   variable   aleatoria   a   valores  naturales,   la   funci\'on   \
$G(\xi)=\sum_{n=0}^{\infty} p_n \xi^n$, con $-1\leq \xi\leq 1$, %% \leq o < ?
es  tambi\'en una  funci\'on generatriz.  Por ejemplo,  si $G$  admite derivadas
primera  y segunda en  $\xi=1$ se  obtienen: $\langle  N\rangle=G'(1)$, $\langle
N(N-1)\rangle=G''(1)$, $\Var(N)=G''(1)+G'(1)-[G'(1)]^2$; adem\'as, se obtiene la
ley   de   distribuci\'on   evaluando   derivadas   de   $G$   en   $\xi=0$:   \
$p_n=\frac{G^{(n)}(0)}{n!}$.  %% Ej: probar
\cite{Fra09}%%p.73

\hfill

La \emph{funci\'on caracter\'istica}  (CF, \emph{characteristic function}) tiene
argumento complejo: \cite{Luk61}
$$
C_X(\xi) \equiv \langle e^{i \xi X} \rangle = \int e^{i \xi x} p(x) \, dx .
$$
La importancia  de esta  funci\'on reside  en que siempre  existe y  est\'a bien
definida, dado que es la  transformada de Fourier de una funci\'on absolutamente
integrable (i.e. $\int |f(x)| \, dx < \infty$) \cite{Gol61}

Si la pdf \ $p(x)$ es de cuadrado integrable, entonces 
$$
p(x) = \frac{1}{2	pi} \int e^{-i \xi x} C_X(\xi) \, d\xi .
$$
El requisito  para esta importante relaci\'on es  que \ $\int_{-\infty}^{\infty}
|p(x)|^2 \, dx<\infty$;  sin embargo, a\'un es v\'alida  para distribuciones con
una contribuci\'on  tipo $\delta$.  Por otro  lado los momentos,  si existen, se
obtienen derivando la funci\'on $C$ tal como expresa la siguiente proposici\'on:

\textbf{Proposici\'on:} \ %%
La  variable aleatoria  $X$  admite  momento de  orden  $r$ si  y  s\'olo si  la
funci\'on caracter\'istica $C$ es $r$ veces derivable en $\xi=0$, siendo
$$
\langle X^r\rangle = (-i)^r C_X^{(r)}(0) . 
$$

Por ejemplo, en el caso de la distribuci\'on de Cauchy--Lorentz resulta
$$
C(\xi)     =     \frac{\gamma}{\pi}    \int_{-\infty}^{\infty}     \frac{e^{i\xi
    x}}{\gamma^2+(x-x_0)^2} dx = e^{-\gamma |\xi| e^{i x_0\xi}}
$$
tomando $\gamma >0$. Esta funci\'on est\'a  definida para todo $\xi$, pero no es
derivable en $\xi=0$,  lo que coincide con el hecho de  que no est\'an definidos
los momentos para esta pdf.

Para  una   variable  aleatoria  compleja   $Z=X+iY$,  usando  la   noci\'on  de
transformada de Fourier bidimensional, se define:
$$
C_Z(\mu) \equiv \int e^{\mu^* z-\mu z^*} p(z) \, d^2z .
$$

Resumimos algunas propiedades importantes de la funci\'on caracter\'istica:
\begin{enumerate}
\item $C(0) =1$
%
\item $|C(\xi)|\leq C(0)$ %%dem.
%
\item $C(\xi)$  es una  funci\'on continua  en $\Rset$ (a\'un  si la  pdf $p(x)$
  tiene discontinuidades) %dem.
%
\item $C(-\xi) = C(\xi)*$
%
\item  $C(\xi)$ es  definida no  negativa,  de tal  forma que  para un  conjunto
  arbitrario  de  $N$  n\'umeros  reales $\xi_1,\ldots,\xi_N$  y  $N$  n\'umeros
  complejos $a_1,\ldots,a_N$, se cumple
  $$
  \sum_{i,j=1}^N a_i^* a_j C(\xi_j-\xi_i) \geq 0 .
  $$
%
\item  $C(\xi) =  M(i\xi) =  F(e^{i\xi}-1)$, si  $M$ y  $F$ existen;  \ $F(\xi)=
  M(\ln(1+\xi))$
\end{enumerate}

{\teorema (Bochner, Goldberg).... } %%

\textbf{Proposici\'on:} \ %%
Sean $X$ e  $Y$ dos variables aleatorias reales  independientes, cuyas funciones
caracter\'isticas son $C_X$ y $C_Y$. Entonces \ $C_{X+Y}=C_X C_Y$.

\hfill

Cumulant generating function .... %%

\hfill

Extendemos  la  definici\'on  de   funci\'on  caracter\'istica  para  un  vector
aleatorio. ... %%


....
}


\SZ{Hablar de esperanza condicional}